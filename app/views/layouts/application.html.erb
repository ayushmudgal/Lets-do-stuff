
<!DOCTYPE html>
<html>
<head>
  <title>Let's Do Stuff</title>
  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track' => true %>
  <%= javascript_include_tag 'application', 'data-turbolinks-track' => true %>
  <%= csrf_meta_tags %>

</head>

<body>
    <div id="main">
        <% if current_user.present? %>
            <div class="container">
                <div class="row profile">
                    <div class="col-md-2">
                        <div class="profile-sidebar">
                            <div class="profile-userpic">
                                <%= link_to 'Let\'s Do Stuff!', root_path, class: "navbar-brand" %>
                                <%= image_tag current_user.avatar.url(:thumb), :class=>"img-responsive" %>
                            </div>

                            <div class="profile-usertitle">
                                <div class="profile-usertitle-name">
                                    <%= link_to current_user.name, user_path(current_user) %>
                                </div>
                            </div>

                            <div class="profile-usermenu">
                                <ul class="nav">
                                    <li class="active">
                                        <%= link_to '<i class="glyphicon glyphicon-home"></i>Create a new room'.html_safe, new_room_path %>
                                    </li>

                                     <!-- <li class="dropdown">
                                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false" style= "text-transform: none"> Friends <span class="caret"></span></a>
                                          <ul class="dropdown-menu"  >
                                            <% if current_user.friends.empty? %>
                                              <ul >You have no Friends! Make some by joining a Room!</ul>
                                            <%else%>
                                              <% current_user.friends.each do |friend| %>
                                                 <ul><%= link_to friend.name, user_path(friend)%></ul>
                                              <%end%>
                                            <% end %>
                                        </ul>
                                      </li>

                                     <li class="dropdown">
                                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false" style= "text-transform: none"> Friend Requests <span class="caret"></span></a>
                                          <ul class="dropdown-menu" >
                                            <%if current_user.pending_invited_by.empty?%>
                                               <ul>No Pending Requests</ul>
                                            <% else %>
                                              <% current_user.pending_invited_by.each do |request| %>
                                                 <ul><%= link_to request.name, user_path(request)%></ul>
                                              <% end %>
                                            <% end %>
                                        </ul>
                                      </li> -->


                                      <div class="list">
                                        <h4>
                                            <span id="friendSpan">My Friends +</span>
                                         </h4>
                                           <ul  visibility: hidden>
                                             <% if !current_user.friends.empty? %>
                                               <% current_user.friends.each do |friend| %>
                                                <li><%= link_to friend.name, user_path(friend)%></li>
                                               <%end%>
                                              <%else%>
                                                  <li>You have no Friends! Make some by joining a Room!</li>
                                             <% end %>
                                         </ul>
                                       </div>

                                      <div class="list">
                                        <h4>
                                            <span id="friendRequestSpan">Friend Requests +</span>
                                        </h4>
                                           <ul  visibility: hidden>
                                             <%if !current_user.pending_invited_by.empty?%>
                                               <% current_user.pending_invited_by.each do |request| %>
                                                  <li><%= link_to request.name, user_path(request)%></li>
                                               <% end %>
                                              <% else %>
                                                 <li>No Pending Requests</li>
                                             <% end %>
                                         </ul>
                                       </div>




                                    <li>
                                        <%= link_to "Logout", destroy_user_session_path, :method => :delete %>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-10">
                        <div class="profile-content">
                            <%= yield %>
                        </div>
                    </div>
                </div>
            </div>



        <% else %>
            <!-- <div class="profile-content"> -->
                <%= yield %>
            <!-- </div> -->
        <% end %>

    </div>

     <script type="text/javascript">
      $(document).ready(function() {


          $(".list h4").click(function () {
            if(document.getElementById("friendSpan").innerHTML == "My Friends +"){
                $(this).next("ul").show(600);
               document.getElementById("friendSpan").innerHTML = "My Friends -";
             }else{
              if(document.getElementById("friendSpan").innerHTML == "My Friends -"){
                $(this).next("ul").hide(600);
               document.getElementById("friendSpan").innerHTML = "My Friends +";
              }
             }

             if(document.getElementById("friendRequestSpan").innerHTML == "Friend Requests +"){
                 $(this).next("ul").show(600);
                document.getElementById("friendRequestSpan").innerHTML = "Friend Requests -";
              }else{
               if(document.getElementById("friendRequestSpan").innerHTML == "Friend Requests -"){
                 $(this).next("ul").hide(600);
                document.getElementById("friendRequestSpan").innerHTML = "Friend Requests +";
               }
              }
        });


     });
    </script>


</body>
</html>
